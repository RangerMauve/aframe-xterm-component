<!doctype html>
<meta charset='utf-8'>
<title>aframe-xterm-component</title>
<link rel="stylesheet" href="//unpkg.com/xterm@3.12.0/dist/xterm.css" />
<script src="//unpkg.com/xterm@3.12.0/dist/xterm.js"></script>
<script src="//aframe.io/releases/0.9.0/aframe.min.js"></script>
<script type="text/javascript" src="aframe-xterm-component.js"></script>
<script type="text/javascript">

AFRAME.registerComponent('xterm-example', {
  dependencies: ['xterm'],
  init: function() {
    const message = `Run \e[0;32m'node server.js'\e[=l to open a shell`
    const xterm = this.el.components['xterm']

    xterm.write(message)

    const socket = new WebSocket('ws://localhost:8080/')

    socket.onmessage = ({data}) => {
      xterm.write(data)
    }

    // Listen on data, write it to the terminal
    xterm.term.on('data', (data) => {
      socket.send(data)
    })

    console.log(xterm.term)
  }
})
</script>
<a-scene>
  <a-entity
    xterm-example
    geometry="primitive: plane; width: 4; height: 2"
    position="0 2 -2"
  ></a-entity>

  <a-entity wasd-controls>
    <a-entity camera look-controls position="0 1.6 0">
    <a-entity cursor="rayOrigin: mouse"></a-entity>
    <a-entity laser-controls="hand: right"></a-entity>
  </a-entity>
  <a-sky color="#101010"></a-sky>
</a-scene>
