<!doctype html>
<meta charset='utf-8'>
<title>aframe-xterm-component</title>
<link rel="stylesheet" href="//unpkg.com/xterm@3.12.0/dist/xterm.css" />
<script src="//unpkg.com/xterm@3.12.0/dist/xterm.js"></script>
<script src="//aframe.io/releases/0.9.0/aframe.min.js"></script>
<script type="text/javascript" src="aframe-xterm-component.js"></script>
<script type="text/javascript">

AFRAME.registerComponent('xterm-example', {
  dependencies: ['xterm'],
  init: function() {
    const message = 'Run \x1B[1;3;31m\'node server.js\'\x1B[0m to open a shell\n'
    const xterm = this.el.components['xterm']

    xterm.write(message)

    const socket = new WebSocket('ws://localhost:8080/')

    socket.onmessage = ({data}) => {
      xterm.write(data)
    }

    // Listen on data, write it to the terminal
    xterm.term.on('data', (data) => {
      socket.send(data)
    })

    console.log(xterm.term)
  }
})
</script>
<a-scene antialias="true">
  <a-entity
    class="terminal"
    xterm-example
    geometry="primitive: plane; width: 4; height: 2"
    position="0 2 -3"
  ></a-entity>

    <a-entity camera look-controls wasd-controls position="0 1.6 0">
    <a-entity cursor="rayOrigin: mouse" raycaster="objects: .terminal"></a-entity>
    <a-entity hand-controls laser-controls raycaster="objects: .terminal"></a-entity>
  <a-sky color="#101010"></a-sky>
</a-scene>
